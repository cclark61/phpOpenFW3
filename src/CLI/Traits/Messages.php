<?php
//*****************************************************************************
//*****************************************************************************
/**
 * CLI Messages Trait
 *
 * @package         phpopenfw/phpopenfw3
 * @author          Christian J. Clark
 * @copyright       Copyright (c) Christian J. Clark
 * @website         https://phpopenfw.org
 * @license         https://mit-license.org
 **/
//*****************************************************************************
//*****************************************************************************

namespace phpOpenFW\CLI\Traits;

//*****************************************************************************
/**
 * Messages Trait
 */
//*****************************************************************************
trait Messages
{
    //*************************************************************************
    //*************************************************************************
    // Print Title
    //*************************************************************************
    //*************************************************************************
    public static function PrintTitle($title)
    {
        if ($title) {
            print "\n**********************************************************************\n";
            print ">>>>> {$title} <<<<<";
            print "\n**********************************************************************\n";
        }
    }

    //*************************************************************************
    //*************************************************************************
    // Print Output Header
    //*************************************************************************
    //*************************************************************************
    public static function PrintHeader($text='', $fg_color=null, $bg_color=null)
    {
        if (!$text) {
            return false;
        }
        $msg = "\n**********************************************************************";
        $msg .= "\n*** {$text}";
        $msg .= "\n**********************************************************************\n";
        print self::ColoredMessage($msg, $fg_color, $bg_color);
        return true;
    }

    //*************************************************************************
    //*************************************************************************
    // Print Information
    //*************************************************************************
    //*************************************************************************
    public static function PrintInformation($msg, $depth=0, $fg_color='blue', $bg_color=null)
    {
        self::PrintMessage($msg, $depth, '[i]', $fg_color, $bg_color);
    }

    //*************************************************************************
    //*************************************************************************
    // Print Confirmation
    //*************************************************************************
    //*************************************************************************
    public static function PrintConfirmation($msg, $depth=0, $fg_color='green', $bg_color=null)
    {
        self::PrintMessage($msg, $depth, '[ok]', $fg_color, $bg_color);
    }

    //*************************************************************************
    //*************************************************************************
    // Print Warning
    //*************************************************************************
    //*************************************************************************
    public static function PrintWarning($msg, $depth=0, $fg_color='yellow', $bg_color=null)
    {
        self::PrintMessage($msg, $depth, '[!!]', $fg_color, $bg_color);
    }

    //*************************************************************************
    //*************************************************************************
    // Print Error
    //*************************************************************************
    //*************************************************************************
    public static function PrintError($msg, $depth=0, $fg_color='red', $bg_color=null)
    {
        self::PrintMessage($msg, $depth, "[ERROR]", $fg_color, $bg_color);
    }

    //*************************************************************************
    //*************************************************************************
    // Print Bullet
    //*************************************************************************
    //*************************************************************************
    public static function PrintBullet($msg, $depth=0, $fg_color=null, $bg_color=null)
    {
        self::PrintMessage($msg, $depth, "->", $fg_color, $bg_color);
    }

    //*************************************************************************
    //*************************************************************************
    // Print Bullet
    //*************************************************************************
    //*************************************************************************
    public static function PrintLine($msg, $depth=0, $fg_color=null, $bg_color=null)
    {
        self::PrintMessage($msg, $depth, '', $fg_color, $bg_color);
    }

    //*************************************************************************
    //*************************************************************************
    // Print Message
    //*************************************************************************
    //*************************************************************************
    public static function PrintMessage($msg, $depth=0, $prefix='', $fg_color=null, $bg_color=null)
    {
        $tabs = '';
        if ($depth) {
            $tabs = str_pad('', $depth, "\t", STR_PAD_LEFT);
        }
        if ($tabs) {
            $msg = $tabs . $msg;
        }
        if ($prefix) {
            $msg = $prefix . ' ' . $msg;
        }
        print self::ColoredMessage($msg, $fg_color, $bg_color) . "\n";
    }

    //*************************************************************************
    //*************************************************************************
    // Print Error and Exit
    //*************************************************************************
    //*************************************************************************
    public static function PrintErrorExit($msg, $fg_color='red', $bg_color=null)
    {
        self::PrintError($msg, 0, $fg_color, $bg_color);

        $msg = "\n**********************************************************************";
        $msg .= "\n*** Exited with Error";
        $msg .= "\n**********************************************************************\n\n";
        print self::ColoredMessage($msg, $fg_color, $bg_color);
        exit;
    }

    //*************************************************************************
    //*************************************************************************
    // Colored Message
    //*************************************************************************
    //*************************************************************************
    public static function ColoredMessage($msg, $fg_color=null, $bg_color=null)
    {
        $fg_colors = [
            'black'         => '0;30',
            'dark_gray'     => '1;30',
            'blue'          => '0;34',
            'light_blue'    => '1;34',
            'green'         => '0;32',
            'light_green'   => '1;32',
            'cyan'          => '0;36',
            'light_cyan'    => '1;36',
            'red'           => '0;31',
            'light_red'     => '1;31',
            'purple'        => '0;35',
            'light_purple'  => '1;35',
            'brown'         => '0;33',
            'yellow'        => '1;33',
            'light_gray'    => '0;37',
            'white'         => '1;37',
        ];
        $bg_colors = [
            'black'         => '40',
            'red'           => '41',
            'green'         => '42',
            'yellow'        => '43',
            'blue'          => '44',
            'magenta'       => '45',
            'cyan'          => '46',
            'light_gray'    => '47'
        ];

        $colors = '';
        if (isset($fg_colors[$fg_color])) {
            $colors .= "\033[" . $fg_colors[$fg_color] . "m";
        }
        if (isset($bg_colors[$bg_color])) {
            $colors .= "\033[" . $bg_colors[$bg_color] . "m";
        }

        if ($colors) {
            return "{$colors}{$msg}\033[0m";
        }

        return $msg;
    }
}
